<!DOCTYPE html>

<!--suppress HtmlDeprecatedAttribute -->
<head>
    <meta charset="utf-8">
    <title>IPR Analysis 5: sig-alpha forecasting</title>
    <link rel="stylesheet" type="text/css" href="style.css">
    <!-- Load up MathJax for math notation -->
    <script type="text/x-mathjax-config">
        MathJax.Hub.Config({
            TeX: { equationNumbers: { autoNumber: "AMS" } }
        });
    </script>
    <script type="text/x-mathjax-config">
        MathJax.Hub.Config({
              tex2jax: {inlineMath: [['$','$'], ['\\(','\\)']]}
        });
    </script>
    <script type="text/javascript"
            src="../mathjax/MathJax.js?config=TeX-AMS-MML_SVG">
            // src="../mathjax/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
    </script>

</head>

<body>
<!-- Add my custom pager script -->
<script type="text/javascript" src="scripts/pager.js"></script>
<link rel="stylesheet" type="text/css" href="scripts/pager.css">

<header>
    <h1>Isotropic Polarization Rotation Analysis 5: Basic Forecasting of Angle Uncertainty on B18 sims</h1>

    <time datetime="2022-03-28" class="published updated">
        2023 Mar 28
    </time> â€”
    J. Cornelison
</header>

<hr>

\(
\newcommand{\Cl}{\mathcal{C}_\ell}
\newcommand{\Cb}{\mathcal{C}_b}
\newcommand{\oCb}{\mathcal{\hat C}_b}
\newcommand{\rCb}{\mathcal{C'}_b}
\newcommand{\Ccov}{\mathrm{\mathbf{C}}}
\newcommand{\siga}{\sigma_\alpha}
\newcommand{\sigasq}{\sigma_\alpha^2}
\newcommand{\choll}{\mathbf{L}}
\newcommand{\BX}{\textbf{X}}
\newcommand{\BY}{\textbf{Y}}
\newcommand{\BI}{\textbf{I}}
\newcommand{\BBE}{\mathbb{E}}
\newcommand{\cov}{\text{Cov}}
\require{cancel}
\require{color}
\newcommand{\tozero}[1]{\color{red}{\bcancel{\color{black}{#1}}}\color{black}}
\)

<p>
    This posting is part of a series which comprises the IPR analysis, see <a href="#references">previous postings</a> for more on this.
</p>
<p>
    This posting goes over some rudimentary forecasting of uncertainty on &alpha; given some reduction in BB power due to e.g. delensing or including more CMB data.
</p>


<hr>

<section>
    <h2>Forecasting Angle Uncertainty from BB power</h2>
<p>
    In this section, we look into a simple forecasting technique that we can use to provide an educated guess on our limits on an IPR constraint in future analysis.
    i.e. predicting a $\siga$ givin some reduction in BB power in either lensing signal, noise, or dust.
    For context, this exercise is mostly to provide the foundation on a discussion of future analyses in our paper.
</p>
    <p>We can show that the variance on &alpha; of the individual signal types add linearly to the variance of angles of the coadded signals. The same can be shown for that of BB power. The table below shows the angle variance from each fit-type (fit to bins 2-10) of B18's 499 matrix-purified sims (sernum 6614) and BB power for each signal type. In the middle and bottom sets of rows (i.e. the &sigma;<sup>2</sup>-rows), I compare the sum of the variances of the individual signal types to the variance of the coadded spectra of those signal types. We can see pretty clearly that the sum of the variances is equal to the variance of the coadded spectra to <5% for TB and <1% for EB, EB+TB, and BB-power.
</p>

    <figure class="table">
        <table>
            <tr>
                <th>Signal</th>
                <th class="cstart">EB</th>
                <th>TB</th>
                <th>EB+TB</th>
                <th class="cstart">BBmean</th>
            </tr>

            <tr>
                <th></th>
                <th class="cstart" colspan="3">&sigma;<sub>&alpha;</sub><sup>2</sup> [Deg<sup>2</sup>]</th>
                <th class="cstart">[&mu;K<sup>2</sup>]</th>
            </tr>

            <tr>
                <td class=''>Lensed-LCDM</td>
                <td class='cstart'>0.0026</td>
                <td class=''>0.0094</td>
                <td class=''>0.0026</td>
                <td class='cstart'>0.0109</td>
            </tr>
            <tr>
                <td class=''>Noise</td>
                <td class='cstart'>0.0027</td>
                <td class=''>0.0110</td>
                <td class=''>0.0027</td>
                <td class='cstart'>0.0167</td>
            </tr>
            <tr>
                <td class=' rend'>Dust</td>
                <td class='cstart rend'>0.0003</td>
                <td class=' rend'>0.0009</td>
                <td class=' rend'>0.0003</td>
                <td class='cstart rend'>0.0007</td>
            </tr>
            <tr>
                <td class=''>&sigma;<sup>2</sup><sub>L</sub>+&sigma;<sup>2</sup><sub>N</sub></td>
                <td class='cstart'>0.0053</td>
                <td class=''>0.0204</td>
                <td class=''>0.0053</td>
                <td class='cstart'>0.0276</td>
            </tr>
            <tr>
                <td class=' rend'>&sigma;<sup>2</sup><sub>L+N</sub></td>
                <td class='cstart rend'>0.0053</td>
                <td class=' rend'>0.0194</td>
                <td class=' rend'>0.0053</td>
                <td class='cstart rend'>0.0276</td>
            </tr>
            <tr>
                <td class=''>&sigma;<sup>2</sup><sub>L</sub>+&sigma;<sup>2</sup><sub>N</sub>+&sigma;<sup>2</sup><sub>D</sub></td>
                <td class='cstart'>0.0056</td>
                <td class=''>0.0213</td>
                <td class=''>0.0056</td>
                <td class='cstart'>0.0284</td>
            </tr>
            <tr>
                <td class=' rend'>&sigma;<sup>2</sup><sub>L+N+D</sub></td>
                <td class='cstart rend'>0.0056</td>
                <td class=' rend'>0.0199</td>
                <td class=' rend'>0.0056</td>
                <td class='cstart rend'>0.0283</td>
            </tr>
        </table>
        <figcaption>
            
        </figcaption>
    </figure>



    <p>
        Because both add linearly, we can derive a simple scaling relation between $\sigasq$ and mean BB power which can then be used to estimate a $\sigasq$ for changes in BB power of a given signal type. The first scenario we consider is delensing, where we are able to reduce the BB power from the lensing signal by a flat 50% across all &ell;-bins. The second is the reduction in noise by incorporating data through 2022 -- B18 has effectively 2.5 years of data and I assume that B2019 through B2022 are just as good as B2018. The last I consider is just combining both B22 with a 50% delensing.
    </p>

    <p>The table below shows these scenarios for L-LCDM+N+D, EB-only fits again assuming we use only bins 2 through 10. For easy comparison, I include the &sigma;<sup>2</sup><sub>L+N+D</sub> from the table above along with a column showing $\siga$.</p>

    <figure class="table">
        <table>
            <tr>
                <th>Signal</th>
                <th colspan="2" class="cstart">EB</th>
                <th class="cstart">BBmean</th>
            </tr>

            <tr>
                <th></th>
                <th class="cstart">&sigma;<sub>&alpha;</sub></th>
                <th class="cstart" colspan="1">&sigma;<sub>&alpha;</sub><sup>2</sup> [Deg<sup>2</sup>]</th>
                <th class="cstart">[&mu;K<sup>2</sup>]</th>
            </tr>

            <tr>
                <td class=''>B18 No Delensing</td>
                <td class='cstart'>0.0747</td>
                <td class='cstart'>0.0056</td>
                <td class='cstart'>0.0283</td>
            </tr>
            <tr>
                <td class=''>B18+50% Delensing</td>
                <td class='cstart'>0.0666</td>
                <td class='cstart'>0.0044</td>
                <td class='cstart'>0.0229</td>
            </tr>
            <tr>
                <td class=''>B22+No Delensing</td>
                <td class='cstart'>0.0653</td>
                <td class='cstart'>0.0043</td>
                <td class='cstart'>0.0220</td>
            </tr>
            <tr>
                <td class=''>B22+50% Delensing</td>
                <td class='cstart'>0.0568</td>
                <td class='cstart'>0.0032</td>
                <td class='cstart'>0.0166</td>
            </tr>

        </table>
        <figcaption>
            Table comparing improvement on $\siga$ for different cases of delensing/including more observing years. Angle was fit over &ell;-bins 2 to 10.
        </figcaption>
    </figure>

    <p>We can expect a ~20% reduction in $\siga$ in either case of only delensing or only including more years and a ~25% reduction if we do both.</p>
    <p>In my previous posting <a href="JAC2023d"></a>, we found that including higher &ell;-bins could improve our $\siga$ by up to 30%. In the next table, I show the same table as above, but fitting to bins 2-15 instead of 2-10. </p>

    <figure class="table">
        <table>
            <tr>
                <th>Signal</th>
                <th colspan="2" class="cstart">EB</th>
                <th class="cstart">BBmean</th>
            </tr>

            <tr>
                <th></th>
                <th class="cstart">&sigma;<sub>&alpha;</sub></th>
                <th class="cstart" colspan="1">&sigma;<sub>&alpha;</sub><sup>2</sup> [Deg<sup>2</sup>]</th>
                <th class="cstart">[&mu;K<sup>2</sup>]</th>
            </tr>

            <tr>
                <td class=''>B18 No Delensing</td>
                <td class='cstart'>0.0497</td>
                <td class='cstart'>0.0025</td>
                <td class='cstart'>0.0958</td>
            </tr>
            <tr>
                <td class=''>B18+50% Delensing</td>
                <td class='cstart'>0.0458</td>
                <td class='cstart'>0.0021</td>
                <td class='cstart'>0.0854</td>
            </tr>
            <tr>
                <td class=''>B22+No Delensing</td>
                <td class='cstart'>0.0409</td>
                <td class='cstart'>0.0017</td>
                <td class='cstart'>0.0676</td>
            </tr>
            <tr>
                <td class=''>B22+50% Delensing</td>
                <td class='cstart'>0.0378</td>
                <td class='cstart'>0.0014</td>
                <td class='cstart'>0.0572</td>
            </tr>

        </table>
        <figcaption>
            Table comparing improvement on $\siga$ for different cases of delensing/including more observing years. Angle was fit over &ell;-bins 2 to 15.
        </figcaption>
    </figure>

    <p>We find we can reduce $\siga$ by up to 50% for the case where we do all three (include up to &ell; bin 15 + 50% delensing + obs years up to B22) compared to our B18, No-Delensing, Fit-bins 2 to 10. Even if we choose not to include those higher &ell;-bins for this analysis, future efforts will probably want to make doing so a priority.</p>

</section>

<hr>

<section class="appendix">

<h2 class="appendix">Appendix</h2>


    <h3>Footnotes</h3>
    <p>Click on the number to return to the main text.</p>
    <div class="footnote">
        <p>
        <sup><a name="ftn1" href="#sup1">[1]</a></sup>

    </p>
    </div>
<!--    <h3>Code</h3>-->
<!--    <p>Below is a list of code that was used for this analysis. The code is committed to the pipeline and can be found in the <tt>analysis/beammap/</tt> directory.</p>-->
<!--    <p id="code"></p>-->

<!--    <h3>Data</h3>-->
<!--    <p id="data"></p>-->
    <h3>References</h3>

    <p id="references"></p>


    <p id="testp"></p>



    <script type="text/javascript">

        // Shorthand tags
        var codes = [
            "rps_fit_mirror_from_moon.m",
            ];

        // Posting titles
        var desc = [
            "Derives mirror parameters from observations of the moon.",
        ];

        // Make a list of references
        var post = document.getElementById("code");
        var msg = "<table class=\"code\">";
        for (var code in codes){
            msg = msg + "<tr><td><tt>"+codes[code]+"</tt></td><td> - </td><td>"+desc[code]+"</td>";
        };
        msg = msg+ "</table>";
        post.innerHTML = msg;

    </script>

    <script type="text/javascript">

        // Shorthand tags
        var data = [
            "moonsch.mat",
            ];

        // Posting titles
        var desc = [
            "Metadata of Moon observations",
            ];

        // Make a list of references
        var post = document.getElementById("data");
        var msg = "<table class=\"code\">";
        for (var datum in data) {
            msg = msg + "<tr><td><tt>" + data[datum] + "</tt></td><td> - </td><td>" + desc[datum] + "</td>";
        }
        ;
        msg = msg + "</table>";
        post.innerHTML = msg;

    </script>



    <script type="text/javascript">

        // This my way of making shorthand links.
        // We'll make a couple arrays with the 'tag' and href information
        // and then look through each anchor element for the specified tag.
        // The anchors should then just look like: <a href="tagname"></a>
        // and the script will automatically fill in the hyperlings and text.


        var posting_dir = window.location.href; // What's the current url?

        var bkurl = "bicep.rc.fas.harvard.edu";
        var spurl = "bicep.usap.gov";

        // These are the possible places to find postings
        // The strings are for if you post your posting in that directory.
        var sitemap = {
            jcornelison: "../../../",   // /jcornelison/postings/
            bkcmb : "../../../../",     // /bkcmb/analysis_logbook/analysis/
            bicep3: "../../../",        //
            bicep_array: "../../../",   //
            bicep2: "",                 // We shouldn't be posting in these, but still have postings we can reference.
            keck  : "",                 // keck/analysis_logbook/analysis/
            spuder: "",                 // ~spuder/hieno_analysis_logboo
            bicep1: "",                 // ~bicep1/analysis_logbook_north/
            general_projects:"",
                   };
        // Logbook Site map:
        // personal:www/jcornelison/postings/
        // bkcmb:   www/bkcmb/analysis_logbook/analysis/
        // keck:    www/keck/analysis_logbook/analysis/
        // BICEP3:  www/bicep3/analysis_logbook/
        // BA:      www/bicep_array/analysis_logbook/
        // We shouldn't be posting in these, but still have postings.
        // bicep2:
        // keck:    www/keck/analysis_logbook/analysis/
        // spuder:  www/~spuder/hieno_analysis_logbook/
        // bicep1:  www/~bicep1/analysis_logbook_north/

        // Shorthand tags
        var tags = [
            "JAC2023",
            "JAC2023b",
            "JAC2023c",
            "JAC2023d",
        ];

        // Links
        // Truncate the link down to the www directory in which it lies if you can.
        // This ensures that we can view the linked postings at Pole without the internet.
        var hrefs = [
            "bkcmb/analysis_logbook/analysis/20230207_IPR_angle_fits_to_B2018/",
            "bkcmb/analysis_logbook/analysis/20230214_IPR_B18_mat_pure/",
            "bkcmb/analysis_logbook/analysis/20230214_IPR_pol_rot_sims/",
            "bkcmb/analysis_logbook/analysis/20230328_IPR_high_ell/",


        ];


        // Posting titles
        var desc = [
            "Isotropic Polarization Rotation Analysis: Global Polarization Rotation Fits on Standard B2018 Sims",
            "Isotropic Polarization Rotation Analysis 2: B18 sims and combined EB+TB fits",
            "Isotropic Polarization Rotation Analysis 3: B2018 Polarization Rotation sims",
            "Isotropic Polarization Rotation Analysis 4: Angle estimates including higher ell-bins",
        ];
        // Debug



        var preface = "";
        var keys = Object.keys(sitemap);
        // If we're not at pole or bicep, just post the full URL
        // If we are, go back to the www directory.
        if (posting_dir.match(new RegExp(bkurl))!=bkurl &
            posting_dir.match(new RegExp(spurl))!=spurl){
                preface = "http://" + bkurl+"/";
            }
        else {
            for (key in keys){
                if (posting_dir.match(new RegExp("/"+keys[key]+"/"))=="/"+keys[key]+"/"){
                    preface = sitemap[keys[key]];
                };
            };

        };

        // Add the prefixes we can.
        // Only add prefixes to directories in the sitemap so we don't break
        // external references.
        for (ref in hrefs) {
            for (key in keys) {

            // If there's a match, at the prefix and move on.
            if(hrefs[ref].match(new RegExp(keys[key] + "/"))==keys[key]+"/"){
                hrefs[ref] = preface+hrefs[ref];
                break;
            }
            };
        };

        // posty.innerHTML = preface;

        // Make a list of references
        var post = document.getElementById("references");
        var msg = "<table>";
        for (var tag in tags){
            msg = msg + "<tr><td><a href="+tags[tag]+"></a></td><td> - </td><td>"+desc[tag]+"</td>";
        };
        msg = msg+ "</table>";
        post.innerHTML = msg;

        // Look through all the hyperlinks and insert the proper links to the postings
        var links = document.getElementsByTagName("A");
        for (var link in links){
            for (var tag in tags){
                if (links[link].href.endsWith(tags[tag])){
                    links[link].text = "("+tags[tag]+")";
                    links[link].href = hrefs[tag];
                    links[link].target = "_blank";
                }
            }
        }

    </script>
</section>




</body>
