<!DOCTYPE html>

<head>
    <meta charset="utf-8">
    <title>RPS Grid Cal — J. Cornelison</title>
    <link rel="stylesheet" type="text/css" href="style.css">
    <!-- Load up MathJax for math notation -->
    <script type="text/x-mathjax-config">
        MathJax.Hub.Config({
            TeX: { equationNumbers: { autoNumber: "AMS" } }
        });
    </script>
    <script type="text/x-mathjax-config">
        MathJax.Hub.Config({
              tex2jax: {inlineMath: [['$','$'], ['\\(','\\)']]}
        });
    </script>
    <script type="text/javascript"
            src="../mathjax/MathJax.js?config=TeX-AMS-MML_SVG">
            // src="../mathjax/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
    </script>

</head>

<body>
<!-- Add my custom pager script -->
<script type="text/javascript" src="scripts/pager.js"></script>
<link rel="stylesheet" type="text/css" href="scripts/pager.css">

<header>
    <h1>RPS Analysis: Wire Grid Polarization Angle Calibration</h1>

    <time datetime="2020-xx-xx" class="published updated">
        yyyy Mmm dd
    </time> —
    J. Cornelison
</header>

<hr>

<p>
    We observe the Rotating Polarized Source (RPS) to determine the polarization angle of the CMB in absolute terms making three primary connections:
    <ol>
    <li>Determine the angle to the RPS's polarizing wire grid with respect to gravity.</li>
    <li>Relate the polarization angle of the telescope WRT to the source.</li>
    <li>Relate the polarization angle of the CMB WRT the telescope.</li>
</ol>
</p>
<p>
    This posting covers part 1: Determining the polarization angle of the RPS's wire grid WRT to gravity. I will also eventually discuss the viability of cross-checking this with the ISAAC.
</p>

<hr>
<section>
<h2>Introduction</h2>

    <figure>
        <img src="figs/rps_annotated.png"/>
        <figcaption>
            Typical setup of the Rotating Polarized Source for polarization calibration. A. 95GHz Broad Spectrum Noise Source. B. Thorlabs rotation stage. C. Polarizing Wire Grid. D. Tuff Tilt precision tilt meter.
        </figcaption>
    </figure>

    <p>Relating the polarization orientation of the wire grid occurs in two steps:
    <ol type="I">
        <li>Measuring the angle of the polarizing wire grid WRT to a reference surface.</li>
        <li>Measuring the angle of the reference surface with respect to gravity.</li>
    </ol>
    </p>
    <p>The first part is accomplished by measuring the mechanical orientation of the grid's wires in a Bridgeport (AKA knee mill) using the top flat surface of the rotation stage as the reference plane -- the arrow from B points to this surfase in figure 1.1. The second part is accomplished using the RPS's tilt meter: with the RPS completely assembled, we place a precision machinist level on the reference surface of the rotation stage and record the number given by the tilt meter when the level is perfectly centered. In addition, I monitor the output of the tilt meter during the entire campaign.</p>

    <p>Thus, when we're observing the RPS on-mast we calculate the angle of the wire grid WRT gravity, $\theta_{grav}$, using our knowledge of the stage's command angle, $\theta_{stage}$, grid-horizontal, $\theta_{grid}$, tilt meter output, $\theta_{tilt}$, and tilt meter calibration $\theta_{tilt,0}$:
    </p>
    \begin{equation}
    \theta_{grav} = \theta_{stage}-\theta_{grid}+\theta_{tilt}-\theta_{tilt,0}
    \end{equation}
    <p>
        The following sections describe how we accomplish parts I and II in detail.
    </p>
</section>
<section><h2>Calibrating the Wire Grid Angle WRT Reference Surface</h2>
    <p>
        During the 2021/2022 RPS campaign, the wire grid calibration followed a similar procedure outlined in <a href="http://bicep3.bicepkeck.org/calibration/calibration_hardware_logbook.html#20131108">JMK's 08-Nov-2013 Entry</a> in the Calibration HW Logbook which I paraphrase here:
    </p>
    <ol>
        <li>Install RPS rotation stage into Bridgeport vise</li>
        <li>Use a dial indicator to square the reference surface on the rotation stage (typically to <0.02&deg;)</li>
        <li>Install a centering scope in the bridgeport spindle to locate wires</li>
        <li>Home the rotation stage</li>
        <li>Determine the angle of the wire grid WRT to the reference surface</li>
        <ul>
            <li>Command the stage to an angle such that there is zero apparent travel in the wires when driving the linear stage of the bridgeport.</li>
            <!--<li>The angle of the grid is $tan^{-1} \left(\frac{\text{wires travelled}\times\text{wire pitch}}{\text{stage distance travelled}}\right)$ </li>-->
        </ul>

        <li>Optional: Manually adjust the wire grid orientation such that the wires align with the home angle.</li>
    </ol>

    <p>Before the RPS went on the mast in late December, I zeroed the RPS grid to the homing position and measured the grid angle to be 0.004&deg;. When we brought the RPS down from the mast in late January, I had less that 24 hours before I was supposed to leave Pole and so opted to use the ISAAC to double check the health of the stage before packing up (more on that later). I disassembled and packed the RPS in such a way that I could repeat the bridgeport measurements when I returned to the states.
    </p>
    <p>In early March, I measured the wire grid angle on the bridgeport at Harvard in the Smithsonian's RX Lab. This time there was a small amount of backlash in the rotation stage:
    </p>
    <ul>
        <li>Putting slight pressure on the shroud in the clockwise direction, the wire grid angle was at exactly the same value: 0.004&deg;.</li>
        <li>With pressure in the counter-clockwise direction, the wire grid was at an angle of 0.057&deg;</li>
    </ul>

    <p>I'm fairly certain this backlash developed during travel.</p>

    <h4>Homing repeatability</h4>

    <p>I determine the homing repeatability of the stage by commanding the RPS to -180&deg;, then to 180&deg; and then homing again, recording the angle at each homing. Before the RPS went on the mast in late December, I measured the the grid angle to be to be centered at 0.004&deg; with a 1&sigma; standard deviation of 0.0002&deg; (Left plot of Figure 1.1).
    </p>
    <p>
        After assembling the RPS and ISAAC here in the lab and doing a number of measurements, I re-measured the homing repeatability, this time recording both angles due to the backlash (see right plot of Figure 1.1).
    </p>


<figure>
    <img src="figs/grid_cal.png"/>
    <figcaption>

    </figcaption>
</figure>

<!--    <table>-->
<!--        <tr>-->
<!--            <th>Grid Angle</th>-->
<!--            <th>Knob Angle</th>-->
<!--        </tr>-->
<!--    </table>-->

<!--    <h3>Independent Cross-Checks with the ISAAC</h3>-->


<!--    <figure>-->
<!--        <img alt="Name pager" id="isaacpager" src="#" width="100%"/>-->
<!--        <figcaption>-->
<!--            Example pager-->
<!--        </figcaption>-->
<!--        <script type="text/javascript">-->

<!--            var vstart = 35;-->
<!--            var vallist2 = new Array(vstart);-->
<!--            for (var ii=0; ii<=vstart-1; ++ii) {-->
<!--                vallist2[ii] = ii+6;-->

<!--            }-->

<!--            var valopt2 = new Pager.DataList(vallist2);-->
<!--            valopt2.toString = function() {-->
<!--                var val = this.list[this.idx].toString();-->
<!--                while (val.length < 3) { val = "0"+val; }-->
<!--                return val;-->
<!--            }-->
<!--            valopt2.fromString = function(val) {-->
<!--                return parseInt(val);-->
<!--            }-->

<!--            pager.link("#isaacpager",-->
<!--                {-->
<!--                    //'Measurement|meas': ['No Homing, No fine sw.|009','With homing, No fine sw.|011','Added Fine Homing sw|022','Post RPS obs|023'],-->
<!--                    'Measurement|meas':  valopt2,-->
<!--                    'Fitter|fittype': ['fmin','lsq','complex'],-->
<!--                    'Weight|wgt': ['Uniform|_uniform', 'Threshold|_threshold','1/Amp|_one_on_r'],-->
<!--             },-->
<!--                function(params) {-->
<!--                    return 'figs/isaac_cal_'+params.meas+params.wgt+'_'+params.fittype+'.png';-->
<!--                });-->
<!--            pager.setparams({-->
<!--                'wgt': '_uniform',-->
<!--                'fittype': 'fmin',-->
<!--                'meas':'009'-->
<!--            });-->
<!--        </script>-->
<!--    </figure>-->


</section>

<section>
    <h2>Calibrating the Reference Surface Angle WRT Gravity</h2>
<p>
We determine the orientation of the reference surface to gravity using a high-precision tilt meter.
</p>

    <h3>Calibration</h3>
    <p>

    </p>
    <h3>Real-Time Monitoring</h3>
    <p>
        During the RPS observations, I recorded the output of the tilt meter using a Labjack in order to monitor and correct for any changes in the orientation of the RPS as detected by the tilt meter. In the figure below, I show the output of the tilt meter during RPS observations with two very different weather conditions:
    </p>

        <figure>
            <img alt="Name pager" id="monitorpager" src="#" width="100%"/>
            <figcaption>
                RPS tilt meter monitor plots for some select days to demonstrate the effect of weather on the RPS wire grid angle. The gray boundary represents the error due to uncertainties in the tilt meter calibration.
            </figcaption>
            <script type="text/javascript">

                pager.link("#monitorpager",
                    {
                        //'Measurement|meas': ['No Homing, No fine sw.|009','With homing, No fine sw.|011','Added Fine Homing sw|022','Post RPS obs|023'],
                        'Day|day':  ['59583','59587'],

                 },
                    function(params) {
                        return 'figs/tilt_monitor_plot_day_'+params.day+'.png';
                    });
                pager.setparams({
                    'day': '59583',
                });
            </script>
        </figure>

    <p>
        In another posting, I will show the improvements to the overall scatter in the per-detetor polarization angle estimates with and without tilt correction.
    </p>

</section>
<section>
<h2>Summary</h2>

</section>


<!--<section>-->
<!--    <h2>Cross Checks</h2>-->
<!--    <h3>In-Situ Absolute Angle Checker (ISAAC)</h3>-->
<!--    <h3>Diffraction Pattern Measurements</h3>-->

<!--</section>-->


<!--
Example codes
<figure class="table">
    <table class="results">
        <tr>
            <th>Schedule</th>
            <th>Start</th>
            <th>End</th>
            <th>DK</th>
        </tr>
        <tr>
            <td>8_ffflat_moonraster_28_dk000_001.sch</td>
            <td>170121 22:29:58</td>
            <td>170121 23:25:36</td>
            <td>0</td>
        </tr>
        <tr>
            <td>8_ffflat_moonraster_28_dk045_001.sch</td>
            <td>170121 23:26:36</td>
            <td>170122 00:20:45</td>
            <td>45</td>
        </tr>
        <tr>
            <td>8_ffflat_moonraster_28_dk090_001.sch</td>
            <td>170122 00:36:46</td>
            <td>170122 01:31:05</td>
            <td>90</td>
        </tr>

    </table>
<figcaption>
    Example results table
</figcaption>
</figure>
<p>
Example equation:
</p>

\begin{equation}
x_0 = 2 \sin(r_0/2) \cos(\theta_0)\\
y_0 = 2 \sin(r_0/2) \sin(\theta_0)
\end{equation}


<p>An example footnote<sup><a href="#ftn1">1</a></sup> and reference citation <a href="CAB2012"></a>.</p>
  <p>
Example pager:
</p>
<figure>
    <img alt="Name pager" id="namepager" src="#" width="65%"/>
    <figcaption>
        Example pager
    </figcaption>
    <script type="text/javascript">
        pager.link("#namepager",
            {
                'Select A|a': ['Yesname|yesparam', 'No|no'],
                'Select B|b': ['One|1','Two|2'],
            },
            function(params) {
                return 'figs/plot_param1_'+params.a+'_param2_'+params.b+'.png';
            });
        pager.setparams({
            'a': 'no',
            'b': '1',
        });
    </script>
</figure>

-->


<hr>

<section class="appendix">
    <h2 class="appendix">Appendix</h2>

<!--    <h3>Footnotes</h3>-->
<!--    <p>Click on the number to return to the main text.</p>-->
<!--    <div class="footnote">-->
<!--        <p>-->
<!--        <sup><a name="ftn1" href="#sup1">[1]</a></sup>-->
<!--        This is a footnote. Click the number to return to main text.-->
<!--    </p>-->
<!--    </div>-->
<!--    <h3>Code</h3>-->
<!--    <p>Below is a list of code that was used for this analysis. The code is committed to the pipeline and can be found in the <tt>analysis/beammap/</tt> directory.</p>-->
<!--    <p id="code"></p>-->

<!--    <h3>Data</h3>-->
<!--    <p id="data"></p>-->
<!--    <h3>References</h3>-->

<!--    <p id="references"></p>-->


<!--    <p id="testp"></p>-->

<!--    <script type="text/javascript">-->

<!--        // Shorthand tags-->
<!--        var codes = [-->
<!--            "rps_fit_mirror_from_moon.m",-->
<!--            ];-->

<!--        // Posting titles-->
<!--        var desc = [-->
<!--            "Derives mirror parameters from observations of the moon.",-->
<!--        ];-->

<!--        // Make a list of references-->
<!--        var post = document.getElementById("code");-->
<!--        var msg = "<table class=\"code\">";-->
<!--        for (var code in codes){-->
<!--            msg = msg + "<tr><td><tt>"+codes[code]+"</tt></td><td> - </td><td>"+desc[code]+"</td>";-->
<!--        };-->
<!--        msg = msg+ "</table>";-->
<!--        post.innerHTML = msg;-->

<!--    </script>-->

<!--    <script type="text/javascript">-->

<!--        // Shorthand tags-->
<!--        var data = [-->
<!--            "moonsch.mat",-->
<!--            ];-->

<!--        // Posting titles-->
<!--        var desc = [-->
<!--            "Metadata of Moon observations",-->
<!--            ];-->

<!--        // Make a list of references-->
<!--        var post = document.getElementById("data");-->
<!--        var msg = "<table class=\"code\">";-->
<!--        for (var datum in data) {-->
<!--            msg = msg + "<tr><td><tt>" + data[datum] + "</tt></td><td> - </td><td>" + desc[datum] + "</td>";-->
<!--        }-->
<!--        ;-->
<!--        msg = msg + "</table>";-->
<!--        post.innerHTML = msg;-->

<!--    </script>-->



<!--    <script type="text/javascript">-->

<!--        // This my way of making shorthand links.-->
<!--        // We'll make a couple arrays with the 'tag' and href information-->
<!--        // and then look through each anchor element for the specified tag.-->
<!--        // The anchors should then just look like: <a href="tagname"></a>-->
<!--        // and the script will automatically fill in the hyperlings and text.-->


<!--        var posting_dir = window.location.href; // What's the current url?-->

<!--        var bkurl = "bicep.rc.fas.harvard.edu";-->
<!--        var spurl = "bicep.usap.gov";-->

<!--        // These are the possible places to find postings-->
<!--        // The strings are for if you post your posting in that directory.-->
<!--        var sitemap = {-->
<!--            jcornelison: "../../../",   // /jcornelison/postings/-->
<!--            bkcmb : "../../../../",     // /bkcmb/analysis_logbook/analysis/-->
<!--            bicep3: "../../../",        //-->
<!--            bicep_array: "../../../",   //-->
<!--            bicep2: "",                 // We shouldn't be posting in these, but still have postings we can reference.-->
<!--            keck  : "",                 // keck/analysis_logbook/analysis/-->
<!--            spuder: "",                 // ~spuder/hieno_analysis_logboo-->
<!--            bicep1: "",                 // ~bicep1/analysis_logbook_north/-->
<!--            general_projects:"",-->
<!--                   };-->
<!--        // Logbook Site map:-->
<!--        // personal:www/jcornelison/postings/-->
<!--        // bkcmb:   www/bkcmb/analysis_logbook/analysis/-->
<!--        // keck:    www/keck/analysis_logbook/analysis/-->
<!--        // BICEP3:  www/bicep3/analysis_logbook/-->
<!--        // BA:      www/bicep_array/analysis_logbook/-->
<!--        // We shouldn't be posting in these, but still have postings.-->
<!--        // bicep2:-->
<!--        // keck:    www/keck/analysis_logbook/analysis/-->
<!--        // spuder:  www/~spuder/hieno_analysis_logbook/-->
<!--        // bicep1:  www/~bicep1/analysis_logbook_north/-->

<!--        // Shorthand tags-->
<!--        var tags = [-->
<!--            "CAB2012",-->
<!--        ];-->

<!--        // Links-->
<!--        // Truncate the link down to the www directory in which it lies if you can.-->
<!--        // This ensures that we can view the linked postings at Pole without the internet.-->
<!--        var hrefs = [-->
<!--            "keck/analysis_logbook/analysis/20120510_beam_map_pointing/",-->
<!--        ];-->


<!--        // Posting titles-->
<!--        var desc = [-->
<!--            "Pointing Model for Keck Beam Maps",-->
<!--        ];-->
<!--        // Debug-->
<!--        var posty = document.getElementById("testp");-->


<!--        var preface = "";-->
<!--        var keys = Object.keys(sitemap);-->
<!--        // If we're not at pole or bicep, just post the full URL-->
<!--        // If we are, go back to the www directory.-->
<!--        if (posting_dir.match(new RegExp(bkurl))!=bkurl &-->
<!--            posting_dir.match(new RegExp(spurl))!=spurl){-->
<!--                preface = "http://" + bkurl+"/";-->
<!--            }-->
<!--        else {-->
<!--            for (key in keys){-->
<!--                if (posting_dir.match(new RegExp("/"+keys[key]+"/"))=="/"+keys[key]+"/"){-->
<!--                    preface = sitemap[keys[key]];-->
<!--                };-->
<!--            };-->

<!--        };-->

<!--        // Add the prefixes we can.-->
<!--        // Only add prefixes to directories in the sitemap so we don't break-->
<!--        // external references.-->
<!--        for (ref in hrefs) {-->
<!--            for (key in keys) {-->

<!--            // If there's a match, at the prefix and move on.-->
<!--            if(hrefs[ref].match(new RegExp(keys[key] + "/"))==keys[key]+"/"){-->
<!--                hrefs[ref] = preface+hrefs[ref];-->
<!--                break;-->
<!--            }-->
<!--            };-->
<!--        };-->

<!--        // posty.innerHTML = preface;-->

<!--        // Make a list of references-->
<!--        var post = document.getElementById("references");-->
<!--        var msg = "<table>";-->
<!--        for (var tag in tags){-->
<!--            msg = msg + "<tr><td><a href="+tags[tag]+"></a></td><td> - </td><td>"+desc[tag]+"</td>";-->
<!--        };-->
<!--        msg = msg+ "</table>";-->
<!--        post.innerHTML = msg;-->

<!--        // Look through all the hyperlinks and insert the proper links to the postings-->
<!--        var links = document.getElementsByTagName("A");-->
<!--        for (var link in links){-->
<!--            for (var tag in tags){-->
<!--                if (links[link].href.endsWith(tags[tag])){-->
<!--                    links[link].text = "("+tags[tag]+")";-->
<!--                    links[link].href = hrefs[tag];-->
<!--                    links[link].target = "_blank";-->
<!--                }-->
<!--            }-->
<!--        }-->

<!--    </script>-->
</section>
</body>
